[{"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\index.js":"1","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\App.js":"2","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\context\\AuthContext.js":"3","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\firebase-config.js":"4","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Header.jsx":"5","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Footer.jsx":"6","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Signup.jsx":"7","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Login.jsx":"8","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Sidebar.jsx":"9","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Profile.jsx":"10","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\SideMenu.jsx":"11","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\ChatBox.jsx":"12","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Matching.jsx":"13","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Loading.jsx":"14","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\ChatList.jsx":"15","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Tendency.jsx":"16"},{"size":431,"mtime":1691249339684,"results":"17","hashOfConfig":"18"},{"size":1664,"mtime":1691305386299,"results":"19","hashOfConfig":"18"},{"size":641,"mtime":1691249339681,"results":"20","hashOfConfig":"18"},{"size":1293,"mtime":1691249339682,"results":"21","hashOfConfig":"18"},{"size":1453,"mtime":1691249339663,"results":"22","hashOfConfig":"18"},{"size":840,"mtime":1691249339662,"results":"23","hashOfConfig":"18"},{"size":6283,"mtime":1691249339680,"results":"24","hashOfConfig":"18"},{"size":2980,"mtime":1691249339672,"results":"25","hashOfConfig":"18"},{"size":2030,"mtime":1691249339679,"results":"26","hashOfConfig":"18"},{"size":7213,"mtime":1691249339676,"results":"27","hashOfConfig":"18"},{"size":1077,"mtime":1691255010471,"results":"28","hashOfConfig":"18"},{"size":7805,"mtime":1691333234517,"results":"29","hashOfConfig":"18"},{"size":5555,"mtime":1691308009071,"results":"30","hashOfConfig":"18"},{"size":1939,"mtime":1691305386303,"results":"31","hashOfConfig":"18"},{"size":6687,"mtime":1691325726996,"results":"32","hashOfConfig":"18"},{"size":2001,"mtime":1691328463491,"results":"33","hashOfConfig":"18"},{"filePath":"34","messages":"35","suppressedMessages":"36","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"37"},"fbh7gf",{"filePath":"38","messages":"39","suppressedMessages":"40","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"41","usedDeprecatedRules":"37"},{"filePath":"42","messages":"43","suppressedMessages":"44","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"37"},{"filePath":"45","messages":"46","suppressedMessages":"47","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"37"},{"filePath":"48","messages":"49","suppressedMessages":"50","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"37"},{"filePath":"51","messages":"52","suppressedMessages":"53","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"54","usedDeprecatedRules":"37"},{"filePath":"55","messages":"56","suppressedMessages":"57","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"37"},{"filePath":"58","messages":"59","suppressedMessages":"60","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"61","usedDeprecatedRules":"37"},{"filePath":"62","messages":"63","suppressedMessages":"64","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"37"},{"filePath":"65","messages":"66","suppressedMessages":"67","errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"68","usedDeprecatedRules":"37"},{"filePath":"69","messages":"70","suppressedMessages":"71","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"37"},{"filePath":"72","messages":"73","suppressedMessages":"74","errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"75","messages":"76","suppressedMessages":"77","errorCount":0,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":0,"fixableWarningCount":0,"source":"78","usedDeprecatedRules":"37"},{"filePath":"79","messages":"80","suppressedMessages":"81","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"37"},{"filePath":"82","messages":"83","suppressedMessages":"84","errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"85","usedDeprecatedRules":"37"},{"filePath":"86","messages":"87","suppressedMessages":"88","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\index.js",[],[],[],"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\App.js",["89","90"],[],"import './App.css';\r\n\r\nimport Header from './components/Header';\r\nimport Footer from './components/Footer';\r\nimport Login from './components/Login';\r\nimport Signup from './components/Signup';\r\nimport ChatBox from './components/ChatBox';\r\nimport ChatList from './components/ChatList';\r\nimport Matching from './components/Matching';\r\nimport SideMenu from './components/SideMenu';\r\nimport Profile from './components/Profile';\r\nimport Sidebar from './components/Sidebar';\r\n\r\nimport Loading from './components/Loading';\r\nimport Tendency from './components/Tendency';\r\n\r\n\r\nimport { Route, Routes, useLocation, Navigate } from 'react-router-dom';\r\n\r\n\r\n\r\n\r\nfunction App() {\r\n\r\n  const location = useLocation();\r\n  const showSideMenu = location.pathname === '/chatbox' || location.pathname === '/chatlist' || location.pathname === '/matching' || location.pathname === '/profile';\r\n\r\n\r\n  return (\r\n    <div className=\"body\">\r\n      <Header/>\r\n\r\n      {showSideMenu && <Sidebar><SideMenu/></Sidebar>}\r\n\r\n      {/* <Sidebar><SideMenu/></Sidebar> */}\r\n\r\n      <Routes>\r\n        <Route path='/signup' element={<Signup/>}></Route>\r\n        <Route path='/' element={<Login/>}></Route>\r\n        <Route path='/chatbox' element={<ChatBox/>}></Route>\r\n        <Route path='/chatlist' element={<ChatList/>}></Route>\r\n        <Route path='/matching' element={<Matching/>}></Route>\r\n        <Route path='/profile' element={<Profile/>}></Route>\r\n        {/* 테스트용 */}\r\n        <Route path='/loading' element={<Loading/>}></Route>\r\n        <Route path='/tendency' element={<Tendency/>}></Route>\r\n      </Routes>\r\n\r\n      {/* <Footer/> */}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\context\\AuthContext.js",[],[],"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\firebase-config.js",[],[],"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Header.jsx",[],[],"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Footer.jsx",["91","92","93"],[],"import React from 'react'\r\n\r\nconst Footer = () => {\r\n  return (\r\n    <div className='footer'>\r\n      <div className='source'>\r\n        <hr/>\r\n        <img src='https://gj-aischool.or.kr/wp-content/uploads/2023/04/ais_dark.png'/>\r\n        <img src='https://www.data.go.kr/images/biz/common/logo/logo-footer-01.png'/>\r\n        <img src = 'https://knto.or.kr/humanframe/theme/kto/assets/image/_layout/logo_kto.svg'/>\r\n      </div>\r\n      <div className='member'>\r\n        <hr/>\r\n        <h3>4기 App 반 - OS TEAM</h3>\r\n        <p> 제작자 : 프론트 앤드 - 이찬용 ,  국지호 / 백앤드 - 임영찬 ,  전도희</p>\r\n        <strong>광주 인공지능 사관학교</strong>\r\n        <p> 주소 : 광주광역시 동구 제봉로 92 (대성학원 1-3층)</p>\r\n        <hr/>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Footer","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Signup.jsx",[],[],"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Login.jsx",["94","95"],[],"import React, { useState } from \"react\";\r\nimport { useNavigate, Link } from \"react-router-dom\";\r\nimport { signInWithEmailAndPassword } from \"firebase/auth\";\r\nimport { auth } from \"../firebase-config\";\r\n\r\n\r\nconst Login = () => {\r\n\r\n  const [err, setErr] = useState(false);\r\n  const nav = useNavigate();\r\n\r\n  // 팝업창을 끄기 위해 만든 함수안에 들어가는 변수를 담기위한 것.-작업자 : 이찬용 \r\n  const [isVisible, setIsVisible] = useState(true);\r\n\r\n  \r\n  // main_popup_page_close 안에 들어가는 함수, 팝업창을 끄기 위한 함수.-작업자 : 이찬용\r\n  const closePopup = () => {\r\n      setIsVisible(false);\r\n  }\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const email = e.target[0].value;\r\n    const password = e.target[1].value;\r\n\r\n    try {\r\n      await signInWithEmailAndPassword(auth, email, password);\r\n      nav('/chatlist')\r\n    } catch (err) {\r\n      alert('이메일 혹은 비밀번호가 틀렸습니다!')\r\n      setErr(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className='login_page'>\r\n          <div className={isVisible ? 'main_popup_page' : 'hidden'}>\r\n            <button className='main_popup_page_close' onClick={closePopup}>X</button>\r\n            <div className='main_popup_page_text'>\r\n              <h1>안녕하세요. 반가워요.</h1><br/>\r\n              <p>저희는 <strong>App</strong>반의 <strong>OS</strong>팀입니다. </p>\r\n              <p>저희가 제작한 웹서비스는 소개팅 웹입니다.</p>\r\n              <p>AI를 이용하여 취향을 분석한 뒤 딱 맞는 이성에게 매칭해 드립니다.</p>\r\n              <p>사랑해 주셔서 감사합니다.</p><br/>\r\n              <h4>팀원</h4>\r\n              <p>제작  :  이찬용, 전도희, 국지호, 임영찬</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"login_bgm_b\">\r\n            <video className=\"login_bgm\" autoPlay muted loop>\r\n              <source src='videos/mainmain8.mp4' type='video/mp4' />\r\n            </video>\r\n          </div>\r\n          <div className='login_box'>\r\n            <div className=\"login_box_header_name\">\r\n              <h1>Login</h1>\r\n            </div>\r\n            <form onSubmit={handleSubmit} className=\"loginbox_in_input_box\">\r\n              <input\r\n              className=\"id_box\"\r\n              id=\"id\"\r\n              placeholder=\"이메일..\"\r\n              ></input>\r\n              <input\r\n              className=\"ps_box\"\r\n              id=\"password\"\r\n              type=\"password\"\r\n              placeholder=\"비밀번호..\"\r\n              \r\n              ></input>\r\n              <button className=\"login_submit_button\">Login</button>\r\n            </form>\r\n            {/* <a href='#' className=\"find_ps_id\">비밀번호 찾기 / 아이디 찾기</a> */}\r\n        </div>\r\n        <div className=\"login_desing_font1\">some.</div>\r\n        <div className=\"login_desing_font2\">line</div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Login;","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Sidebar.jsx",[],[],"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Profile.jsx",["96","97","98","99"],[],"import React, { useRef, useState, useContext, useEffect } from 'react';\r\nimport 'swiper/css';\r\nimport 'swiper/css/effect-cards';\r\nimport {v4} from 'uuid'\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport { db, firebase } from \"../firebase-config\";\r\nimport {\r\n  collection,\r\n  where,\r\n  onSnapshot,\r\n  query,\r\n  orderBy,\r\n  getDoc,\r\n  getDocs,\r\n  updateDoc\r\n} from \"firebase/firestore\";\r\nimport { updateProfile } from \"firebase/auth\"\r\nimport { getStorage, ref, getDownloadURL, uploadBytes} from \"firebase/storage\";\r\n\r\nconst Profile = () => {\r\n  const { currentUser } = useContext(AuthContext);\r\n  const [user, setUser] = useState(null);\r\n  const [imageUpload, setImageUpload] = useState(null);\r\n  const [profileImage, setProfileImage] = useState(null);\r\n  const [name, setName] = useState(\"\");\r\n\r\n  const [originalUser, setOriginalUser] = useState(null); // 작업자 : 이찬용 8월 5일 12시\r\n\r\n\r\n  const storage = getStorage(firebase);\r\n\r\n  // 현재 로그인 유저 정보 조회를 위한 기능\r\n  useEffect(() => {\r\n    if (currentUser && currentUser.email) {\r\n      const q = query(collection(db, \"users\"), where(\"id\", \"==\", currentUser.email));\r\n      getDocs(q).then((querySnapshot) => {\r\n        querySnapshot.forEach((doc) => {\r\n          const userData = doc.data();\r\n          setUser(userData);\r\n          setOriginalUser(userData);\r\n  \r\n          // 초기 이름과 사진 상태 설정\r\n          setName(userData.name);\r\n          setProfileImage(userData.profileUrl);  // 이미지 URL 저장, Firebase Storage에서 가져옵니다.\r\n        });\r\n      });\r\n    }\r\n  }, [currentUser]);\r\n\r\n  useEffect(() => {\r\n    if (user && user.profileUrl) {\r\n      const storage = getStorage();\r\n      getDownloadURL(ref(storage, user.profileUrl))\r\n        .then((url) => {\r\n          const img = document.getElementById('myimg');\r\n          if (img) {\r\n            img.setAttribute('src', url);\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          alert(`에러 : ${error}`);\r\n        });\r\n    }\r\n  }, [user]);\r\n\r\n\r\n  // user가 null인 경우, Loading 메시지를 표시\r\n  if (!user) {\r\n    return <p>Loading...</p>;\r\n  }\r\n\r\n  const handleImageChange = (event) => {\r\n    const file = event.target.files[0];\r\n    setImageUpload(file)\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onloadend = () => {\r\n      setProfileImage(reader.result);\r\n    };\r\n    console.log(`userRef: ${user}`);\r\n  };\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n\r\n    // 이름과 이미지가 비어 있는지를 확인 하기 위해 존재합니다.\r\n    const isNameChanged = name !== originalUser.name;\r\n    const isImageChanged = imageUpload !== null;\r\n\r\n    if (isNameChanged || isImageChanged) {      //프로필 내용추가되면. 여기도 추가, 이찬용: 8월 5일 12시\r\n      try {\r\n        let downloadUrl;\r\n        if (isImageChanged) {\r\n          const imageRef = ref(storage, `images/${name + v4()}`);\r\n          await uploadBytes(imageRef, imageUpload);\r\n          downloadUrl = await getDownloadURL(imageRef);\r\n        } else {\r\n          // 이미지가 들어오지 않으면 null값의 이미지로 변경시키는 문제가 발생하여 수정하여 넣은 부분입니다. -이찬용\r\n          // 이미지가 변경되지 않았다면 기존 URL을 사용합니다.\r\n          downloadUrl = originalUser.profileUrl;\r\n        }\r\n\r\n        await updateProfile(currentUser, {\r\n          displayName: isNameChanged ? name : originalUser.name,\r\n          photoURL: downloadUrl,\r\n        });\r\n  \r\n        const usersRef = collection(db, \"users\");\r\n        const querySnapshot = await getDocs(\r\n          query(usersRef, where(\"id\", \"==\", currentUser.email))\r\n        );\r\n        \r\n        // 삼항식을 추가 하였습니다. isNameChanged 가 트루면 name을 팔스면 originalUser.name를 사용하게 했습니다. --이찬용\r\n        // 변경되었으면 새로운 이름을 아니면 기존의 이름을 사용하게 하였습니다.  -- 이찬용\r\n        querySnapshot.forEach((doc) => {\r\n          updateDoc(doc.ref, {\r\n            name: isNameChanged ? name : originalUser.name,\r\n            profileUrl: downloadUrl,\r\n          });\r\n        });\r\n  \r\n        // 프로필 업데이트 후 새로운 사용자 정보를 가져와서 화면에 표시합니다. \r\n        const updatedUser = { ...user, name: isNameChanged ? name : originalUser.name, profileUrl: downloadUrl };\r\n        setUser(updatedUser);\r\n\r\n        alert('수정완료')\r\n      } catch (error) {\r\n        alert(`수정실패\\nerror: ${error}`);\r\n      }\r\n    } else {\r\n      alert(\"수정된 정보가 없습니다.\");\r\n    }\r\n  };\r\n\r\n  // user가 null이 아닌 경우, 프로필 정보를 화면에 표시\r\n  return (\r\n    <div className='matching_bg'>\r\n      <div className=\"login_bgm_b\">\r\n        <video className=\"login_bgm\" autoPlay muted loop>\r\n          <source src='videos/mainmain15.mp4' type='video/mp4' />\r\n        </video>\r\n      </div>\r\n      <div className='profile_in_box'>\r\n        <div className='profile_box_header_box'>\r\n          <div className='profile_box_logo'></div>\r\n          <div className='profile_box_header_name'>Profile</div>\r\n        </div>\r\n       \r\n        <div className='profile_img_chainge_box'>\r\n          <div className='profile_img_text'><h1>사진</h1></div>\r\n          <div className='profile_img_chainge_input_box'>\r\n            <div className='profile_img_chainge'>\r\n              <img \r\n                src={profileImage || currentUser.photoURL || 'defaultImageLink'} \r\n                alt=\"변경할 사진\" \r\n                className=\"profile_img_chainge_at\" \r\n              />\r\n            </div>\r\n            <input\r\n              type=\"file\"\r\n              onChange={handleImageChange}\r\n              accept=\"image/*\"\r\n              className='profile_img_chainge_btn'\r\n            />\r\n          </div>\r\n        </div>\r\n        <div  className='profile_name_chainge_box'>\r\n          <div className='profile_name_chainge_text'><h1>이름</h1></div>\r\n          <form className=\"profile_name_chainge_input\">\r\n            <input\r\n            className=\"profile_name_input_in\"\r\n            id=\"id\"\r\n            placeholder= {`현재 이름은 \"${user.name}\"입니다.`}\r\n            onChange={(e) => setName(e.target.value)}\r\n            maxLength={6}\r\n            // value={name}     // 플레이스 홀더보다 상위라서 홀더플레이스가 보이지 않는 현상이 일어났습니다. 그래서 주석처리함 --이찬용\r\n            ></input>\r\n          </form>\r\n        </div>\r\n        <div  className='profile_myinfo_box'>\r\n          <div className='profile_myinfo_box_text'><h1>자기 소개</h1></div>\r\n          <form className=\"profile_myinfo_box_input\">\r\n            <textarea\r\n            className=\"profile_myinfo_box_input_in\"\r\n            // id=\"id\"\r\n            type='textarea'\r\n            ></textarea>\r\n          </form>\r\n        </div>\r\n        <div className='profile_chainge_button_box'><button onClick={handleSubmit} className='profile_submit_button'>수정하기</button></div>\r\n      </div>\r\n      \r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Profile;","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\SideMenu.jsx",[],[],"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\ChatBox.jsx",["100","101","102","103","104","105","106","107","108"],[],"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Matching.jsx",["109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124"],[],"import React, { useRef, useState, useContext, useEffect } from 'react';\r\nimport { Swiper, SwiperSlide } from 'swiper/react';\r\nimport 'swiper/css';\r\nimport 'swiper/css/effect-cards';\r\nimport { EffectCards } from 'swiper/modules';\r\nimport { AuthContext } from \"../context/AuthContext\";\r\n\r\nimport { Autoplay, Pagination, Navigation } from 'swiper/modules';\r\n\r\nimport { db, firebase } from \"../firebase-config\";\r\nimport {\r\n  collection,\r\n  where,\r\n  onSnapshot,\r\n  query,\r\n  orderBy,\r\n  getDocs,\r\n  updateDoc,\r\n  addDoc,\r\n  arrayUnion\r\n} from \"firebase/firestore\";\r\nimport { getStorage, ref, getDownloadURL, uploadBytes} from \"firebase/storage\";\r\n\r\n\r\nconst Matching = () => {\r\n\r\n  const { currentUser } = useContext(AuthContext);\r\n  const [user, setUser] = useState(null);\r\n  const [isVisiblePopup, setIsVisiblePopup] = useState(true);\r\n  const matClosePopup = () => {\r\n    setIsVisiblePopup(false);\r\n  };\r\n\r\n  const swiperRef = useRef(null);\r\n\r\n  const goNextSlide = () => {\r\n    if (swiperRef.current && swiperRef.current.swiper) {\r\n      swiperRef.current.swiper.slideNext();\r\n      console.log(users[0].matchId);\r\n      console.log(matchUsers);\r\n      console.log(users[0]);\r\n    }\r\n  };\r\n\r\n  const [users, setUsers] = useState([])\r\n  const [matchUsers, setMatchUsers] = useState([])\r\n  const userRef = collection(db, \"users\") \r\n    \r\n  useEffect(()=>{\r\n    if (currentUser && currentUser.email) {\r\n        const queryUsers = query(\r\n            userRef, where(\"id\", \"==\", currentUser.email)\r\n        )\r\n\r\n        const unsuscribe = onSnapshot(queryUsers, (snapshot)=>{\r\n            let users=[]\r\n            snapshot.forEach((doc)=>{\r\n                users.push({...doc.data(), id: doc.id})\r\n            })\r\n            setUsers(users)\r\n        })\r\n        return ()=> unsuscribe()\r\n    }\r\n  },[currentUser])\r\n\r\n  useEffect(() => {\r\n    if (currentUser && currentUser.email) {\r\n      const q = query(collection(db, \"users\"), where(\"id\", \"==\", currentUser.email));\r\n      getDocs(q).then((querySnapshot) => {\r\n        querySnapshot.forEach((doc) => {\r\n          setUser(doc.data());\r\n        });\r\n      });\r\n    }\r\n  }, [currentUser]);\r\n\r\n\r\n  useEffect(() => {\r\n    if (users.length > 0 && users[0].matchId) {\r\n      const matchIdQueries = users[0].matchId.map((id) => (\r\n        query(userRef, where(\"id\", \"==\", id))\r\n      ));\r\n\r\n      Promise.all(matchIdQueries.map((q) => getDocs(q)))\r\n        .then((querySnapshots) => {\r\n          const matchedUsers = [];\r\n          querySnapshots.forEach((querySnapshot) => {\r\n            querySnapshot.forEach((doc) => {\r\n              if (doc.exists()) {\r\n                matchedUsers.push({ ...doc.data(), id: doc.id });\r\n              }\r\n            });\r\n          });\r\n          setMatchUsers(matchedUsers);\r\n\r\n          swiperRef.current.swiper.update();\r\n        });\r\n\r\n      const storage = getStorage();\r\n\r\n      // 수정된 부분: matchedUsers 배열 순회로 변경합니다.\r\n    \r\n    }\r\n  }, [users]);\r\n\r\n  const [addedUsers, setAddedUsers] = useState([]);\r\n  \r\n\r\n  const addUserToList = async(userName) => {\r\n    setAddedUsers((prevUsers) => [...prevUsers, userName]);\r\n    \r\n    alert(`채팅리스트에 ${userName.name}님이 추가되었습니다😊`)\r\n    \r\n    const usersRef = collection(db, \"users\");\r\n    const querySnapshot = await getDocs(\r\n      query(usersRef, where(\"id\", \"==\", currentUser.email))\r\n    );\r\n    querySnapshot.forEach((doc) => {\r\n      updateDoc(doc.ref, {\r\n        chatListName : arrayUnion(userName.name),\r\n        chatListProfileUrl : arrayUnion(userName.profileUrl),\r\n        chatListCreatedAt : arrayUnion(userName.createdAt),\r\n        chatTest : arrayUnion(userName.name)\r\n      });\r\n    });\r\n  };\r\n\r\n      \r\n\r\n      \r\n\r\n\r\n  return (\r\n    <div className='matching_bg'>\r\n        <div className={isVisiblePopup ? 'mat_popup' : 'hidden'}>\r\n          <button className='mat_popup_close' onClick={matClosePopup}>X</button>\r\n          <div className='mat_popup_text'>\r\n            <h4>💬 알림.</h4>\r\n            <p><strong>{currentUser.displayName}</strong>님, 새로운 매칭이 도착했어요!</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"login_bgm_b\">\r\n            <video className=\"login_bgm\" autoPlay muted loop>\r\n              <source src='videos/mainmain10.mp4' type='video/mp4' />\r\n            </video>\r\n        </div>\r\n        <div className='matching_in_box'>\r\n        <Swiper\r\n            effect={'cards'}\r\n            grabCursor={true}\r\n            modules={[EffectCards]}\r\n            className=\"mySwiper\"\r\n            ref={swiperRef}\r\n          >\r\n            {matchUsers.map((user)=>\r\n              <SwiperSlide key={user.name}>\r\n                <div className='mat_info_card'>\r\n                  <div className='info_img_box'>\r\n                    <img className='matching_img'  src={user.profileUrl} />\r\n                  </div>\r\n                  <div className='info_info_box'>\r\n                    {matchUsers.length > 0 && matchUsers[0] ? (\r\n                      <>\r\n                        <p>이름: {user.name}</p>\r\n                        <p>나이: {user.age}</p>\r\n                        <button className='matching_submit_button' onClick={()=>addUserToList(user)}>매칭하기</button>\r\n                      </>\r\n                    ) : (\r\n                      <p>Loading or no matched users found.</p>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </SwiperSlide>\r\n            )}\r\n  \r\n          </Swiper>\r\n        </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Matching","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Loading.jsx",[],[],"C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\ChatList.jsx",["125","126","127","128","129","130","131","132","133","134","135"],[],"\r\nimport React, { useState, useEffect, useRef, useContext } from 'react';\r\nimport VanillaTilt from 'vanilla-tilt';\r\nimport { db, auth } from \"../firebase-config\";\r\nimport {\r\n  collection,\r\n  where,\r\n  onSnapshot,\r\n  query,\r\n  orderBy,\r\n  getDocs,\r\n  arrayRemove,\r\n  updateDoc\r\n} from \"firebase/firestore\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport { chatList } from './Matching';\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Loading from './Loading';\r\n\r\n\r\n/* 바닐라 틸트를 실행시키기 위한 함수입니다. - 작업자: 이찬용\r\n틸트안에 속성을 줌으로서 바닐라 틸트 제작자가 만든 기능들을 활용합니다.\r\n이 바닐라 틸트는 채팅창 대화 미리보기에 적용 되었습니다.*/\r\nfunction Tilt(props) {\r\n  const { options, ...rest } = props;\r\n  const tilt = useRef(null);\r\n\r\n  useEffect(() => {\r\n    VanillaTilt.init(tilt.current, options);\r\n  }, [options]);\r\n\r\n  return <div ref={tilt} {...rest} />;\r\n}\r\n\r\n\r\n\r\n// 팝업창을 끄기 위해 만든 함수안에 들어가는 변수를 담기위한 것입니다. .-작업자 : 이찬용 \r\n\r\nconst ChatList = () => {\r\n\r\n\r\n  const { currentUser } = useContext(AuthContext);\r\n  const nav = useNavigate()\r\n\r\n  // isVisible의 초기값을 false로 설정하여 새로운 메시지가 없을 때는 팝업이 뜨지 않도록 했습니다.\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const closePopup = () => {\r\n    setIsVisible(false);\r\n  };\r\n\r\n  // VanillaTilt를 실행시키기 위한 함수입니다. -작업자 : 이찬용\r\n  const options = {\r\n    scale: 1.01,\r\n    speed: 1000,\r\n    max: 5\r\n  };\r\n\r\n  \r\n  const [chats, setChats] = useState([]);\r\n  const [user, setUser] = useState(null)\r\n\r\n  const userRef = collection(db, \"users\");\r\n  \r\n  const [selectedUser, setSelectedUser] = useState(\"\")\r\n\r\n  useEffect(() => {\r\n    if (currentUser && currentUser.email) {\r\n      const q = query(collection(db, \"users\"), where(\"id\", \"==\", currentUser.email));\r\n      getDocs(q).then((querySnapshot) => {\r\n        querySnapshot.forEach((doc) => {\r\n          setUser(doc.data());\r\n          console.log(`users:${(doc.data().chatListName).length}`);\r\n        });\r\n      });\r\n    }\r\n  }, [currentUser]);\r\n    \r\n  \r\n\r\n  // chats 상태 값이 변화할 때마다 실행되는 useEffect를 추가했습니다. - 작업자 : 이찬용\r\n  // 이로써 새로운 채팅이 추가될 때마다 isVisible 상태 값을 true로 변경하여 팝업창을 띄웁니다.  - 작업자 : 이찬용\r\n  // chats의 이전 값을 기억하기 위한 ref입니다.  - 작업자 : 이찬용\r\n  const prevChats = useRef(chats);\r\n\r\n\r\n  const handleClick = (user, index) => {\r\n    setSelectedUser(user)\r\n    sessionStorage.setItem('selectedUserName', user.chatListName[index])\r\n    sessionStorage.setItem('selectedUserProfileUrl', user.chatListProfileUrl[index])\r\n    \r\n    if (user.chatListProfileUrl[index] > currentUser.displayName) {\r\n      sessionStorage.setItem('selectedRoom', `${user.chatListName[index]}+${currentUser.displayName}`)\r\n    } else {\r\n      sessionStorage.setItem('selectedRoom', `${currentUser.displayName}+${user.chatListName[index]}`)\r\n    }\r\n    nav('/chatbox')\r\n  }\r\n\r\n  const handleClickBot = () => {\r\n    setSelectedUser('챗봇:지호')\r\n    sessionStorage.setItem('selectedUserName', '챗봇:지호')\r\n    sessionStorage.setItem('selectedUserProfileUrl', 'https://firebasestorage.googleapis.com/v0/b/chatapp2-aa1ab.appspot.com/o/images%2F%EA%B5%AD2.jpg?alt=media&token=1e4d4b55-f1b1-4e6f-a030-e06ca28a99d2')\r\n    sessionStorage.setItem('selectedRoom', `챗봇:지호+${currentUser.displayName}`)\r\n    \r\n    nav('/chatbox')\r\n  }\r\n\r\n  const removeUserToList = async(index) => {\r\n\r\n    alert(`채팅리스트에서 ${user.chatListName[index]}님이 삭제되었습니다😥`)\r\n    \r\n    const usersRef = collection(db, \"users\");\r\n    const querySnapshot = await getDocs(\r\n      query(usersRef, where(\"id\", \"==\", currentUser.email))\r\n    );\r\n    querySnapshot.forEach((doc) => {\r\n      updateDoc(doc.ref, {\r\n        chatListName : arrayRemove(doc.data().chatListName[index]),\r\n        chatListProfileUrl : arrayRemove(doc.data().chatListProfileUrl[index]),\r\n        chatListCreatedAt : arrayRemove(doc.data().chatListCreatedAt[index]),\r\n      });\r\n    });\r\n\r\n    nav('/chatlist')\r\n\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* {user? ( */}\r\n    <div className='chatlist_background'>\r\n      <div className={`chatlist_popup_page ${isVisible ? '' : 'hidden'}`}>\r\n        <button className='chatlist_popup_page_close' onClick={closePopup}>X</button>\r\n        <div className='chatlist_popup_page_text'>\r\n          <h4>💬 알림.</h4>\r\n          <p><strong>{currentUser.displayName}</strong>님, 설레이는 새로운 메세지가 도착했어요!</p>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"login_bgm_b\">\r\n        <video className=\"login_bgm\" autoPlay muted loop>\r\n          <source src='videos/mainmain10.mp4' type='video/mp4' />\r\n        </video>\r\n      </div>\r\n\r\n      <div className='chatlist_box'>\r\n        <div className='chatlist_box_in'>\r\n          <div className='chatlist_list_header'><h1>~ group chat room ~</h1></div>\r\n          <hr/>\r\n          <div className='chatlist_inner_box'>\r\n          {user ? (\r\n            <div>\r\n              <Tilt options={options} className='chat_list_contents' onClick={()=>handleClickBot()}>\r\n                <div className='chat_list_profile_img_box'><img className='chat_list_profile_img' src='https://firebasestorage.googleapis.com/v0/b/chatapp2-aa1ab.appspot.com/o/images%2F%EA%B5%AD2.jpg?alt=media&token=1e4d4b55-f1b1-4e6f-a030-e06ca28a99d2' /></div>\r\n                \r\n                <p className='chat_list_name'>챗봇:지호</p>\r\n                <p className='chat_list_talk_preview'>반가워요 ^^</p>\r\n              </Tilt>\r\n            {user.chatListName.map((chat, index) => (\r\n              <Tilt key={index} options={options} className='chat_list_contents' onClick={()=>handleClick(user, index)}>\r\n                \r\n                <div className='chat_list_profile_img_box'><img className='chat_list_profile_img' src={user.chatListProfileUrl[index]}/></div>\r\n                \r\n                <p className='chat_list_name'>{user.chatListName[index]}</p>\r\n                <p className='chat_list_talk_preview'>최근 메시지</p>\r\n                <button className='chatlist_chat_del_btn' onClick={()=>removeUserToList(index)}>나가기</button>\r\n              </Tilt>\r\n            ))}\r\n            </div>\r\n            ):<p>loading...</p>}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    {/* ): <Loading/>} */}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ChatList;","C:\\Users\\im960\\OneDrive\\바탕 화면\\gjproject\\SomeLine\\projectSomeLine\\src\\components\\Tendency.jsx",[],[],{"ruleId":"136","severity":1,"message":"137","line":4,"column":8,"nodeType":"138","messageId":"139","endLine":4,"endColumn":14},{"ruleId":"136","severity":1,"message":"140","line":18,"column":38,"nodeType":"138","messageId":"139","endLine":18,"endColumn":46},{"ruleId":"141","severity":1,"message":"142","line":8,"column":9,"nodeType":"143","endLine":8,"endColumn":87},{"ruleId":"141","severity":1,"message":"142","line":9,"column":9,"nodeType":"143","endLine":9,"endColumn":86},{"ruleId":"141","severity":1,"message":"142","line":10,"column":9,"nodeType":"143","endLine":10,"endColumn":97},{"ruleId":"136","severity":1,"message":"144","line":2,"column":23,"nodeType":"138","messageId":"139","endLine":2,"endColumn":27},{"ruleId":"136","severity":1,"message":"145","line":9,"column":10,"nodeType":"138","messageId":"139","endLine":9,"endColumn":13},{"ruleId":"136","severity":1,"message":"146","line":1,"column":17,"nodeType":"138","messageId":"139","endLine":1,"endColumn":23},{"ruleId":"136","severity":1,"message":"147","line":10,"column":3,"nodeType":"138","messageId":"139","endLine":10,"endColumn":13},{"ruleId":"136","severity":1,"message":"148","line":12,"column":3,"nodeType":"138","messageId":"139","endLine":12,"endColumn":10},{"ruleId":"136","severity":1,"message":"149","line":13,"column":3,"nodeType":"138","messageId":"139","endLine":13,"endColumn":9},{"ruleId":"136","severity":1,"message":"150","line":3,"column":14,"nodeType":"138","messageId":"139","endLine":3,"endColumn":18},{"ruleId":"136","severity":1,"message":"151","line":29,"column":28,"nodeType":"138","messageId":"139","endLine":29,"endColumn":43},{"ruleId":"136","severity":1,"message":"152","line":30,"column":30,"nodeType":"138","messageId":"139","endLine":30,"endColumn":51},{"ruleId":"136","severity":1,"message":"153","line":31,"column":24,"nodeType":"138","messageId":"139","endLine":31,"endColumn":39},{"ruleId":"154","severity":1,"message":"155","line":59,"column":6,"nodeType":"156","endLine":59,"endColumn":20,"suggestions":"157"},{"ruleId":"158","severity":1,"message":"159","line":105,"column":100,"nodeType":"160","messageId":"161","endLine":105,"endColumn":102},{"ruleId":"141","severity":1,"message":"142","line":182,"column":11,"nodeType":"143","endLine":182,"endColumn":70},{"ruleId":"158","severity":1,"message":"162","line":193,"column":48,"nodeType":"160","messageId":"161","endLine":193,"endColumn":50},{"ruleId":"141","severity":1,"message":"142","line":217,"column":11,"nodeType":"143","endLine":217,"endColumn":58},{"ruleId":"136","severity":1,"message":"163","line":8,"column":10,"nodeType":"138","messageId":"139","endLine":8,"endColumn":18},{"ruleId":"136","severity":1,"message":"164","line":8,"column":20,"nodeType":"138","messageId":"139","endLine":8,"endColumn":30},{"ruleId":"136","severity":1,"message":"165","line":8,"column":32,"nodeType":"138","messageId":"139","endLine":8,"endColumn":42},{"ruleId":"136","severity":1,"message":"166","line":10,"column":14,"nodeType":"138","messageId":"139","endLine":10,"endColumn":22},{"ruleId":"136","severity":1,"message":"148","line":16,"column":3,"nodeType":"138","messageId":"139","endLine":16,"endColumn":10},{"ruleId":"136","severity":1,"message":"167","line":19,"column":3,"nodeType":"138","messageId":"139","endLine":19,"endColumn":9},{"ruleId":"136","severity":1,"message":"168","line":22,"column":22,"nodeType":"138","messageId":"139","endLine":22,"endColumn":25},{"ruleId":"136","severity":1,"message":"169","line":22,"column":27,"nodeType":"138","messageId":"139","endLine":22,"endColumn":41},{"ruleId":"136","severity":1,"message":"170","line":22,"column":43,"nodeType":"138","messageId":"139","endLine":22,"endColumn":54},{"ruleId":"136","severity":1,"message":"171","line":28,"column":10,"nodeType":"138","messageId":"139","endLine":28,"endColumn":14},{"ruleId":"136","severity":1,"message":"172","line":36,"column":9,"nodeType":"138","messageId":"139","endLine":36,"endColumn":20},{"ruleId":"154","severity":1,"message":"173","line":64,"column":5,"nodeType":"156","endLine":64,"endColumn":18,"suggestions":"174"},{"ruleId":"136","severity":1,"message":"175","line":99,"column":13,"nodeType":"138","messageId":"139","endLine":99,"endColumn":20},{"ruleId":"154","severity":1,"message":"173","line":104,"column":6,"nodeType":"156","endLine":104,"endColumn":13,"suggestions":"176"},{"ruleId":"136","severity":1,"message":"177","line":106,"column":10,"nodeType":"138","messageId":"139","endLine":106,"endColumn":20},{"ruleId":"141","severity":1,"message":"142","line":159,"column":21,"nodeType":"143","endLine":159,"endColumn":76},{"ruleId":"136","severity":1,"message":"150","line":4,"column":14,"nodeType":"138","messageId":"139","endLine":4,"endColumn":18},{"ruleId":"136","severity":1,"message":"147","line":8,"column":3,"nodeType":"138","messageId":"139","endLine":8,"endColumn":13},{"ruleId":"136","severity":1,"message":"148","line":10,"column":3,"nodeType":"138","messageId":"139","endLine":10,"endColumn":10},{"ruleId":"136","severity":1,"message":"178","line":16,"column":10,"nodeType":"138","messageId":"139","endLine":16,"endColumn":18},{"ruleId":"136","severity":1,"message":"179","line":18,"column":8,"nodeType":"138","messageId":"139","endLine":18,"endColumn":15},{"ruleId":"136","severity":1,"message":"180","line":59,"column":17,"nodeType":"138","messageId":"139","endLine":59,"endColumn":25},{"ruleId":"136","severity":1,"message":"181","line":62,"column":9,"nodeType":"138","messageId":"139","endLine":62,"endColumn":16},{"ruleId":"136","severity":1,"message":"182","line":64,"column":10,"nodeType":"138","messageId":"139","endLine":64,"endColumn":22},{"ruleId":"136","severity":1,"message":"183","line":83,"column":9,"nodeType":"138","messageId":"139","endLine":83,"endColumn":18},{"ruleId":"141","severity":1,"message":"142","line":154,"column":60,"nodeType":"143","endLine":154,"endColumn":257},{"ruleId":"141","severity":1,"message":"142","line":162,"column":60,"nodeType":"143","endLine":162,"endColumn":137},"no-unused-vars","'Footer' is defined but never used.","Identifier","unusedVar","'Navigate' is defined but never used.","jsx-a11y/alt-text","img elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","JSXOpeningElement","'Link' is defined but never used.","'err' is assigned a value but never used.","'useRef' is defined but never used.","'onSnapshot' is defined but never used.","'orderBy' is defined but never used.","'getDoc' is defined but never used.","'auth' is defined but never used.","'setSelectedUser' is assigned a value but never used.","'setSelectedProfileUrl' is assigned a value but never used.","'setSelectedRoom' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'messagesRef'. Either include it or remove the dependency array.","ArrayExpression",["184"],"eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","Expected '!==' and instead saw '!='.","'Autoplay' is defined but never used.","'Pagination' is defined but never used.","'Navigation' is defined but never used.","'firebase' is defined but never used.","'addDoc' is defined but never used.","'ref' is defined but never used.","'getDownloadURL' is defined but never used.","'uploadBytes' is defined but never used.","'user' is assigned a value but never used.","'goNextSlide' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'userRef'. Either include it or remove the dependency array.",["185"],"'storage' is assigned a value but never used.",["186"],"'addedUsers' is assigned a value but never used.","'chatList' is defined but never used.","'Loading' is defined but never used.","'setChats' is assigned a value but never used.","'userRef' is assigned a value but never used.","'selectedUser' is assigned a value but never used.","'prevChats' is assigned a value but never used.",{"desc":"187","fix":"188"},{"desc":"189","fix":"190"},{"desc":"191","fix":"192"},"Update the dependencies array to be: [messagesRef, selectedRoom]",{"range":"193","text":"194"},"Update the dependencies array to be: [currentUser, userRef]",{"range":"195","text":"196"},"Update the dependencies array to be: [userRef, users]",{"range":"197","text":"198"},[1680,1694],"[messagesRef, selectedRoom]",[1795,1808],"[currentUser, userRef]",[2920,2927],"[userRef, users]"]